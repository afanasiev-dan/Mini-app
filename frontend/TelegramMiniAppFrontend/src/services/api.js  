const BACKEND_URL = "https://p2p-hunters.ru";

export async function getUserOrders(userId) {
  const res = await fetch(`${BACKEND_URL}/api/Order/orders/user/${userId}/last-day`);
  if (!res.ok) throw new Error("Ошибка загрузки ордеров");
  return res.json();
}

export async function createOrder(type, data) {
  const endpoint = type === "buy" ? "/api/Order/buy_order" : "/api/Order/sell_order";
  const res = await fetch(`${BACKEND_URL}${endpoint}`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data),
  });
  if (!res.ok) {
    const err = await res.text();
    throw new Error(err);
  }
  return res.json();
}

export async function testApiRequest(type, body) {
  const routes = {
    healthCheck: "/live",
    getClient: (id) => `/api/Client/${id}`,
    getOrderById: (id) => `/api/Order/${id}`,
  };

  const url = routes[type] ? BACKEND_URL + routes[type](body.id) : `${BACKEND_URL}/api/Order`;
  const res = await fetch(url);
  return res.json();
}
