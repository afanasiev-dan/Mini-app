<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <title>HTTP Запрос</title>
</head>

<body>
    <h1>Отправка HTTP-запроса</h1>
    <button id="fetchBtn">Получить данные по юзерам</button>
    <div id="result"></div>

    <button id="fetchOrders">Получить данные по ордерам</button>
    <div id="resultOrders"></div>

    <div id="buyForm" class="screen hidden start-width-column">
        <div class="card" style="max-width: 400px;">
            <div class="card-body">
                <h5 class="card-title text-center mb-4">Создание заявки на покупку</h5>
                <select class="form-select mb-3 bank-select">
                    <option selected value="">Выберите валюту</option>
                    <option value="USDT">USDT</option>
                    <option value="USDC">USDC</option>
                    <option value="BTC">BTC</option>
                    <option value="ETH">ETH</option>
                </select>

                <select class="form-select mb-3 bank-select">
                    <option selected value="">Выберите банк</option>
                    <option value="Т-Банк">Т-Банк</option>
                    <option value="Совкомбанк">Совкомбанк</option>
                    <option value="ПСБ банк">ПСБ банк</option>
                </select>

                <div class="mb-3">
                    <label class="form-label">Сумма</label>
                    <input type="number" class="form-control sum-input" placeholder="0,252">
                </div>
                <div>
                    <label class="form-label">Имя отправителя</label>
                    <input type="text" class="form-control" placeholder="Вася Криптовалютов" />
                </div>
                <button class="btn btn-primary w-100 mt-3" onclick="submitForm('buy')">Создать заявку</button>
            </div>
        </div>
    </div>

    <script>
        function submitBuyForm(action) {
            // 1. Получаем элементы формы
            const currencySelect = document.querySelector('#buyForm .bank-select'); // Первый select - валюта
            const bankSelect = document.querySelectorAll('#buyForm .bank-select')[1]; // Второй select - банк
            const sumInput = document.querySelector('#buyForm .sum-input');
            const senderNameInput = document.querySelector('#buyForm input[placeholder="Вася Криптовалютов"]'); // Можно добавить ID для надёжности

            // 2. Получаем значения
            const currency = currencySelect.value;
            const bank = bankSelect.value;
            const sum = sumInput.value;
            const senderName = senderNameInput.value;
        }

        document.getElementById('fetchBtn').addEventListener('click', async () => {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Загрузка...';

            try {
                // Пример запроса к публичному API (JSONPlaceholder)
                const response = await fetch('https://p2p-hunters.ru/api/Client');

                if (!response.ok) {
                    throw new Error(`Ошибка HTTP: ${response.status}`);
                }

                const data = await response.json();
                resultDiv.innerHTML = `
      <h2>Ответ от сервера:</h2>
      <p><strong>ID:</strong> ${data.totalCount}</p>
      <p><strong>Заголовок:</strong> ${data.clients[0].username} ${data.clients[0].telegramId} ${data.clients[0].fullName}</p>
    `;
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">Ошибка: ${error.message}</p>`;
            }
        });


        document.getElementById('fetchOrders').addEventListener('click', async () => {
            const resultDiv = document.getElementById('resultOrders');
            resultDiv.innerHTML = 'Загрузка...';

            try {
                // Пример запроса к публичному API (JSONPlaceholder)
                const response = await fetch('https://p2p-hunters.ru/api/Order');

                if (!response.ok) {
                    throw new Error(`Ошибка HTTP: ${response.status}`);
                }

                const data = await response.json();
                // Создаем HTML для каждого ордера в массиве
                const ordersHtml = data.map(order => `
                    <div style="border: 1px solid #ccc; margin-bottom: 10px; padding: 10px; border-radius: 5px;">
                        <p><strong>ID:</strong> ${order.id}</p>
                        <p><strong>User Name:</strong> ${order.userName}</p>
                        <p><strong>Type:</strong> ${order.type}</p>
                        <p><strong>Currency:</strong> ${order.currency}</p>
                        <p><strong>Bank:</strong> ${order.bank}</p>
                        <p><strong>Amount:</strong> ${order.amount}</p>
                        <p><strong>Contact Info:</strong> ${order.contactInfo}</p>
                        <p><strong>Payment User Data:</strong> ${order.paymentUserData || 'нет данных'}</p>
                        <p><strong>Status:</strong> ${order.status}</p>
                        <p><strong>Created At:</strong> ${new Date(order.createdAt).toLocaleString('ru-RU')}</p>
                        <p><strong>Changed At:</strong> ${order.changeAt ? new Date(order.changeAt).toLocaleString('ru-RU') : 'нет данных'}</p>
                    </div>
                `).join('');

                resultDiv.innerHTML = `<h2>Ответ от сервера:</h2>${ordersHtml}`;
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">Ошибка: ${error.message}</p>`;
            }
        });
    </script>
</body>

</html>